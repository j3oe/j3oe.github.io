<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Name Watcher + NameMC quick-open</title>
<style>
  body{font-family:Inter,system-ui,Arial;background:#071227;color:#e6eef8;padding:20px}
  .card{background:#0b1320;padding:14px;border-radius:10px;margin-bottom:12px}
  button{background:#00c2ff;color:#001;border:none;padding:8px 10px;border-radius:8px;cursor:pointer}
  .ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#94a3b8}
  .viewer{height:420px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);overflow:hidden;background:#071221;display:flex;align-items:center;justify-content:center}
  .small{color:#94a3b8;font-size:13px}
  a.link{color:#9be7ff}
</style>
</head>
<body>
  <div class="card">
    <h2 style="margin:0 0 8px 0">NameMC quick access</h2>
    <div class="small" style="margin-bottom:8px">
      Full results pages are often blocked from iframes. Use the buttons below to open NameMC results directly or use NameMC's small official search box embedded here.
    </div>

    <!-- Official NameMC embed search box (allowed) -->
    <div style="margin-bottom:10px">
      <label class="small">Search on NameMC (embedded search box):</label>
      <div style="margin-top:8px">
        <!-- NameMC offers an official embed widget (small / medium). This is allowed by the site. -->
        <iframe src="https://namemc.com/embed?size=medium" width="400" height="38" style="border:0"></iframe>
      </div>
      <div class="small" style="margin-top:6px">Tip: type a name and press Enter to jump to NameMC search results in a new tab.</div>
    </div>

    <!-- Try to embed the exact results page; fallback to link if blocked -->
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button id="tryEmbed">Try embed 3-letter results</button>
      <button id="openTab" class="ghost">Open NameMC results (3-letter) in new tab</button>
      <button id="autoOpen" class="ghost">Auto-open results now</button>
    </div>
  </div>

  <div class="card">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <strong>NameMC viewer (may be blocked)</strong>
      <span class="small">If blank, click "Open ... in new tab".</span>
    </div>

    <div id="viewer" class="viewer" style="margin-top:10px">
      <div id="viewerMessage" class="small">Click “Try embed 3-letter results” — if NameMC blocks embedding the full page we’ll show a fallback and you can open results in a new tab.</div>
    </div>

    <div id="fallback" style="margin-top:8px;display:none;">
      <div class="small">Embedding blocked by NameMC. <a id="linkUrl" class="link" target="_blank" rel="noopener">Open NameMC results (3-letter) in a new tab</a></div>
    </div>
  </div>

<script>
const NAMEMC_URL = 'https://namemc.com/minecraft-names?sort=asc&length_op=eq&length=3&lang=&searches=0';
const viewer = document.getElementById('viewer');
const viewerMessage = document.getElementById('viewerMessage');
const fallback = document.getElementById('fallback');
const linkUrl = document.getElementById('linkUrl');

linkUrl.href = NAMEMC_URL;
linkUrl.innerText = 'Open NameMC results (3-letter) in a new tab';

// Try to embed - will often be blocked by X-Frame-Options or CSP, so we test and fallback.
document.getElementById('tryEmbed').onclick = () => {
  fallback.style.display = 'none';
  viewer.innerHTML = ''; // clear
  viewer.appendChild(viewerMessage);
  viewerMessage.innerText = 'Loading...';
  const iframe = document.createElement('iframe');
  iframe.src = NAMEMC_URL;
  iframe.style.width = '100%';
  iframe.style.height = '100%';
  iframe.style.border = '0';
  iframe.loading = 'lazy';
  viewer.appendChild(iframe);

  // after a short delay, check whether it rendered. Many blocked pages will be blank or about:blank.
  setTimeout(()=>{
    let blocked = false;
    try {
      // Accessing contentDocument will throw for cross-origin; but cross-origin is okay.
      // We check if the iframe shows about:blank or has no content body (some blocked pages are blank).
      const doc = iframe.contentDocument || iframe.contentWindow?.document;
      if(!doc || !doc.body || doc.body.innerHTML.trim().length === 0){
        blocked = true;
      }
    } catch(e){
      // If access throws, that usually just means cross-origin (not necessarily blocked).
      // But many sites that allow framing will render — we'll conservatively treat throws as 'possibly blocked'
      // and then check visually by waiting a little longer and seeing if the iframe rendered (but we can't inspect cross-origin).
      // To keep UX simple: treat certain errors as blocked for NameMC.
      blocked = true;
    }
    if(blocked){
      viewer.innerHTML = '<div class="small">Embedding blocked by NameMC (security headers). Use the button below to open results in a new tab.</div>';
      fallback.style.display = 'block';
    } else {
      viewerMessage.remove();
      fallback.style.display = 'none';
    }
  }, 700);
};

// open in new tab always works
document.getElementById('openTab').onclick = () => {
  window.open(NAMEMC_URL, '_blank', 'noopener');
};

// auto open (useful if iframe won't load, but be careful: opens a new tab immediately)
document.getElementById('autoOpen').onclick = () => {
  window.open(NAMEMC_URL, '_blank', 'noopener');
};

// Optionally auto-open on page load (commented out to avoid surprise popups)
// window.open(NAMEMC_URL, '_blank', 'noopener');

</script>
</body>
</html>
